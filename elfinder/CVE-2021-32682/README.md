# elFinder ZIP 인수 삽입이 명령어 삽입으로 이어짐(CVE-2021-32682)

[한국어 버전(Korean version)]

elFinder는 jQuery UI를 사용하여 JavaScript로 작성된 웹용 오픈 소스 파일 관리자입니다.

elFinder 2.1.48 버전과 이전 버전에서 Arguments Injection이 발견되었습니다. 이 취약점을 통해 최소한의 구성이라도 elFinder PHP connector를 호스팅하는 서버에서 임의의 명령을 실행할 수 있습니다. 이 문제는 2.1.59에서 패치되었습니다. 반드시 인증 없이 노출되게 하지 마세요.

참고 자료:

* https://blog.sonarsource.com/elfinder-case-study-of-web-file-manager-vulnerabilities
* https://packetstormsecurity.com/files/164173/elfinder_archive_cmd_injection.rb.txt
* https://xz.aliyun.com/t/10739

## 취약점 환경
elFinder 2.1.48를 시작할려면 다음 명령을 실행하십시오:<br>
<pre><code>docker compose up -d</code></pre>
서버가 시작된 후 <code>http://your-ip:8080</code>에서 elFinder의 메인 페이지를 볼 수 있습니다.

## 취약점 재현
먼저, 이 취약점 흐름을 위해 2개의 파일을 준비헤야됩니다.<br><br>
<code>1.txt</code>라는 일반 텍스트 파일을 만듭니다.<br>
![1](https://github.com/Tjdmin1/whitehat-school-vulhub/blob/main/elfinder/CVE-2021-32682/1.png)

마우스 오른쪽 버튼 클릭 메뉴에서 이 파일을 ZIP 형식으로 보관하고 보관된 파일 이름을 <code>2.zip</code>로 수정합니다
![2](https://github.com/Tjdmin1/whitehat-school-vulhub/blob/main/elfinder/CVE-2021-32682/2.png)
